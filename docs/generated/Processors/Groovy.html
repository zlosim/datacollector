
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="The Groovy Evaluator processes data based on Groovy code. Use the Groovy Evaluator processor to use Groovy code to perform custom processing. The Groovy Evaluator supports Groovy version 2.4. You can ..." /><meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Groovy Evaluator" /><meta name="DC.Relation" scheme="URI" content="../Processors/Processors_title.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="concept_ldh_sct_gv" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Groovy Evaluator</title><!--  Generated with Oxygen version 18.1, build number 2016112217.  --><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/skins/skin.css" /><link rel="stylesheet" type="text/css" href="../skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../index.html";
            
            --></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script>
<!--
    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
</head>
<body onload="highlightSearchTerm()" class="frmBody">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../Processors/Processors_title.html" title="Processors">Processors</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../Processors/Processors_title.html" title="Processors"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Processors</span></a></span>  </span></td></tr></tbody></table>
<div class="nested0" id="concept_ldh_sct_gv">
 <h1 class="title topictitle1">Groovy Evaluator</h1>

 <div class="body conbody">  <p class="p">The Groovy Evaluator processes data based on Groovy code.
      Use the Groovy Evaluator processor to use Groovy code to perform custom processing. The Groovy
      Evaluator supports Groovy version 2.4.</p>

    <div class="p">You can develop the following scripts for the processor: <ul class="ul" id="concept_ldh_sct_gv__d81486e18">
                <li class="li">Initialization script - Optional initialization script that sets up resources or
                    connections required by the processor. The initialization script is run once
                    when the pipeline starts. </li>

                <li class="li">Main processing script - Main script that processes data. The main script is run
                    for each record or each batch of data, based on the configured processing
                    mode.</li>

                <li class="li">Destroy script - Optional destroy script that closes any resources or
                    connections opened by the processor. The destroy script is run once when the
                    pipeline stops.</li>

            </ul>

        </div>

  <p class="p">When you use a Groovy Evaluator in a pipeline, the <span class="ph">Data
                  Collector</span> passes a
      batch of data to the processor and converts the data to a scripting-friendly data structure
      for processing. You can configure the processor to use the invokedynamic bytecode instruction. </p>

    <p class="p">The processor provides extensive sample code that you can use to develop your script. You can
      also call external Java code from the script.</p>

 </div>

<div class="related-links"></div>
<div class="topic concept nested1" id="concept_ljq_z2t_gv">
 <h2 class="title topictitle2">Processing Mode</h2>

 
 <div class="body conbody"><p class="shortdesc">You can choose the processing mode that the Groovy Evaluator uses to process the main
    script. You can use the same script in each processing mode. However, you should include error
    handling in the main script before you run in batch mode.</p>

  <div class="p">The Groovy Evaluator provides the following processing
      modes for the main script: <dl class="dl">
        
                              <dt class="dt dlterm">Record by Record</dt>

                              <dd class="dd">The processor calls the script for each record. The processor
                                    passes the record to the script as a map and processes each
                                    record individually. </dd>

                              <dd class="dd">The script does not require error handling logic. Error records
                                    are passed to the processor for error handling. The processor
                                    handles error records based on the On Record Error
                                    property.</dd>

                              <dd class="dd">Use this mode to avoid including error handling logic in the code.
                                    Since this mode calls the script for each record, pipeline
                                    performance will be negatively affected. </dd>

                        
        
                              <dt class="dt dlterm">Batch by Batch</dt>

                              <dd class="dd">The processor calls the script for each batch. The processor
                                    passes the batch to the script as a list and processes the batch
                                    at one time. </dd>

                              <dd class="dd">Include error handling logic in the script. Without error handling
                                    logic, a single error record sends the entire batch to the
                                    processor for error handling. The processor handles error
                                    records based on the On Record Error property.</dd>

                              <dd class="dd">Use this mode to improve performance by processing a batch of data
                                    at a time.</dd>

                        
      </dl>
</div>

 </div>

</div>
<div class="topic concept nested1" id="concept_hzt_zjt_gv">
 <h2 class="title topictitle2">Groovy Scripting Objects</h2>

 <div class="body conbody">
        <p class="p">You can use different scripting objects in the
            Groovy Evaluator, based on the type of script:</p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="concept_hzt_zjt_gv__table_y2s_m1k_d1b" class="table" frame="border" border="1" rules="all">
                
                
                <thead class="thead" align="left">
                    <tr>
                        <th class="entry" valign="top" width="30%" id="d439593e150">Script Type</th>

                        <th class="entry" valign="top" width="70%" id="d439593e153">Valid Scripting Objects</th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr>
                        <td class="entry" valign="top" width="30%" headers="d439593e150 ">Init</td>

                        <td class="entry" valign="top" width="70%" headers="d439593e153 ">You can use the following scripting objects in the initialization
                                script:<ul class="ul" id="concept_hzt_zjt_gv__d81486e93">
                                <li class="li">state</li>

                                <li class="li">log</li>

                                <li class="li">sdcFunctions - <samp class="ph codeph">getFieldNull</samp>,
                                        <samp class="ph codeph">createMap</samp>, and
                                        <samp class="ph codeph">pipelineParameters</samp> methods</li>

                            </ul>
</td>

                    </tr>

                    <tr>
                     <td class="entry" valign="top" width="30%" headers="d439593e150 ">Main</td>

                     <td class="entry" valign="top" width="70%" headers="d439593e153 ">You can use the following scripting objects in the main
                         script:<ul class="ul" id="concept_hzt_zjt_gv__d81486e122">
                             <li class="li">records</li>

                             <li class="li">state</li>

                             <li class="li">log</li>

                             <li class="li">output</li>

                             <li class="li">error</li>

                             <li class="li">sdcFunctions - all methods</li>

                         </ul>
</td>

                 </tr>

                    <tr>
                        <td class="entry" valign="top" width="30%" headers="d439593e150 ">Destroy</td>

                        <td class="entry" valign="top" width="70%" headers="d439593e153 ">You can use the following scripting objects in the destroy script:<ul class="ul" id="concept_hzt_zjt_gv__d81486e188">
                                <li class="li">state</li>

                                <li class="li">log</li>

                                <li class="li">sdcFunctions - <samp class="ph codeph">getFieldNull</samp>,
                                        <samp class="ph codeph">createMap</samp>, <samp class="ph codeph">createEvent</samp>,
                                        <samp class="ph codeph">toEvent</samp>, and
                                        <samp class="ph codeph">pipelineParameters</samp> methods</li>

                            </ul>
</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p">The scripting objects work the same within each script type:</p>

     
     <dl class="dl">
         
             <dt class="dt dlterm">records</dt>

             <dd class="dd">A collection of records to process. The records object includes different elements based
                 on the processing mode that you use:<ul class="ul" id="concept_hzt_zjt_gv__ul_fdm_5yk_sr">
                     <li class="li">Record by Record - The records array includes one record element. A record includes
                         a single <samp class="ph codeph">value</samp> element. The <samp class="ph codeph">value</samp> element contains
                         the data for the record.</li>

                     <li class="li">Batch by Batch - The records array includes all records in the batch.</li>

                 </ul>
</dd>

             <dd class="dd">Map and list record fields are mapped to Groovy maps and lists, respectively.</dd>

         
     </dl>

     <dl class="dl">
                        
                              <dt class="dt dlterm">state</dt>

                              <dd class="dd">An object to store information between invocations of the init,
                                    main, and destroy scripts. A state is a map object that includes
                                    a collection of key/value pairs. You can use the state object to
                                    cache data such as lookups, counters, or a connection to an
                                    external system.</dd>

                              <dd class="dd">The state object functions much like a member variable: <ul class="ul" id="concept_hzt_zjt_gv__d79952e2790">
                                          <li class="li">The information is transient and is lost when the
                                                pipeline stops or restarts.</li>

                                          <li class="li">The state object is available only for the instance of
                                                the processor stage it is defined in. If the
                                                pipeline executes in cluster mode, the state object
                                                is not shared across nodes.</li>

                                    </ul>
</dd>

                              <dd class="dd">The same instance of the state object is available to all three
                                    scripts. For example, you might use the init script to open a
                                    connection to a database and then store a reference to that
                                    connection in the state object. In the main script, you can
                                    access the open connection using the state object. Then in the
                                    destroy script, you can close the connection using the state
                                    object.</dd>

                              <dd class="dd">
                                    <div class="note warning"><span class="warningtitle">Warning:</span> The state object is best used for a fixed
                                          or static set of data. Adding to the cache on every record
                                          or batch can quickly consume the memory allocated to <span class="ph">Data
                  Collector</span> and cause
                                          out of memory exceptions. </div>

                              </dd>

                        
                        
                              <dt class="dt dlterm">log</dt>

                              <dd class="dd">An object to write messages to the log. Includes four methods:
                                          <samp class="ph codeph">info()</samp>, <samp class="ph codeph">warn()</samp>,
                                          <samp class="ph codeph">debug()</samp>, and <samp class="ph codeph">trace()</samp>. </dd>

                              <dd class="dd">The signature of the four methods is as follows:
                                    <pre class="pre codeblock">(message-template, arguments...) </pre>
The
                                    message template can have positional variables denoted by curly
                                    brackets: { }. The arguments are replaced in the message
                                    template curly brackets in positional manner, i.e., this is the
                                    first argument in the first { } occurrence, and so on.</dd>

                        
                        
                              <dt class="dt dlterm">output</dt>

                              <dd class="dd">An object that writes the record to the output batch. Includes a
                                          <samp class="ph codeph">write(Record)</samp> method.</dd>

                        
                        
                              <dt class="dt dlterm">error</dt>

                              <dd class="dd">An object that passes error records to the processor for error
                                    handling. Includes a <samp class="ph codeph">write(Record, message)</samp>
                                    method.</dd>

                        
                  </dl>

        <dl class="dl">
            
                <dt class="dt dlterm">sdcFunctions</dt>

                <dd class="dd">An object that runs functions that evaluate or modify data. Includes the
                    following methods: </dd>

                <dd class="dd">
                    <ul class="ul" id="concept_hzt_zjt_gv__ul_o2w_4jc_d1b">
                        <li class="li"><samp class="ph codeph">getFieldNull(Record, 'field
                                                path')</samp> - Method that checks if a field is
                                          assigned a constant such as NULL_INTEGER or
                                          NULL_STRING.</li>
<li class="li"><samp class="ph codeph">createRecord(String,
                                                'recordId')</samp> - Method that creates a new
                                          record with the specified fields and values. The recordId
                                          uniquely identifies the record. It should include enough
                                          information to track down the record source.</li>
<li class="li"><samp class="ph codeph">createMap(boolean
                                                listMap)</samp> - Method that creates a map for
                                          use as a field in a record. Pass true to create a list-map
                                          field, or false to create a map field.</li>
<li class="li"><samp class="ph codeph">createEvent(String type, int
                                                version)</samp> - Method that creates a new event
                                          record with the specified event type and version. Be sure
                                          to enable event generation in the stage before
                                          implementing event methods. </li>
<li class="li"><samp class="ph codeph">toEvent(Record)</samp> - Method
                                          that sends an event record to the Event output stream. Be
                                          sure to enable event generation in the stage before
                                          implementing event methods. </li>
<li class="li"><samp class="ph codeph">pipelineParameters()</samp>
                                          - Method that returns a map of all <a class="xref" href="../Pipeline_Configuration/RuntimeValues.html#concept_rjh_ntz_qr" title="Runtime parameters are parameters that you define in a pipeline and then call from within that same pipeline. When you start the pipeline, you specify the parameter values to use. Use runtime parameters to specify values for pipeline properties when you start the pipeline.">runtime parameters</a> defined for the
                                          pipeline.</li>

                    </ul>

                </dd>

            
        </dl>

  </div>

</div>
<div class="topic concept nested1" id="concept_rmp_xlt_gv">
 <h2 class="title topictitle2">Processing List-Map Data</h2>

 
 <div class="body conbody"><p class="shortdesc">In scripts that process list-map data, treat the data as maps. </p>

  <p class="p">List-Map is a <span class="ph">Data
                  Collector</span> data type that
    allows you to use standard record functions to work with delimited data. When an origin reads
    delimited data, it generates List-Map fields by default. </p>

  <p class="p">The Groovy Evaluator reads and passes list-map data. But to process data in a List-Map field,
   treat the field as a Map in the script.</p>

 </div>

</div>
<div class="topic concept nested1" id="concept_u13_flh_tw">
 <h2 class="title topictitle2">Type Handling</h2>

 <div class="body conbody">
  <p class="p">Note the following data type information when
            using the Groovy Evaluator:</p>

        <dl class="dl">
            
                <dt class="dt dlterm">Data type of null values</dt>

                <dd class="dd">
                    <p class="p">The Groovy Evaluator can associate null values with a data type. For example,
                        if the Groovy Evaluator assigns a null value to an Integer field, the field
                        is returned to the pipeline as an integer with a null value.</p>

                    <div class="p">Use constants in the Groovy code to create a new field of a specific data
                        type with a null value. For example, you can create a new String field with
                        a null value by assigning the type constant NULL_STRING to the field as
                        follows:<pre class="pre codeblock">record.value['new_field'] = NULL_STRING</pre>
</div>

                </dd>

            
            
                <dt class="dt dlterm">Date fields</dt>

                <dd class="dd">Use the String data type to create a new field to store a date with a specific
                    format. For example, the following sample code creates a new String field that
                    stores the current date using the format
                    YYYY-MM-dd:<pre class="pre codeblock"> // Define a date object to record the current date
def date = new Date()

for (record in records) {
  try {
    // Create a string field to store the current date with the specified format
    record.value['date'] = date.format('YYYY-MM-dd')
    
    // Write a record to the processor output
    output.write(record)
  } catch (e) {
    // Send a record to error
    log.error(e.toString(), e)
    error.write(record, e.toString())
  }
}</pre>
</dd>

            
        </dl>

 </div>

</div>
<div class="topic concept nested1" id="concept_qcz_ssq_1y">
    <h2 class="title topictitle2">Event Generation</h2>

    <div class="body conbody">
        <p class="p">You can use the Groovy Evaluator <span class="ph">to generate event records
                for an event stream. Enable event generation when you want the processor to generate
                an event record based on scripting logic. </span></p>

        <p class="p">As with any event record, you can pass events downstream to a
            destination for event storage or to any executor that can be configured to use the
            event. For more information about events and the event framework, see <a class="xref" href="../Event_Handling/EventFramework-Title.html#concept_cph_5h4_lx">Dataflow Triggers Overview</a>.</p>

        <div class="p">To generate events:<ol class="ol" id="concept_qcz_ssq_1y__d81486e235">
                <li class="li">On the <span class="keyword wintitle">General</span> tab, select the <span class="ph uicontrol">Produce
                        Events</span> property.<p class="p">This enables the event output stream for use.
                    </p>
</li>

                <li class="li">In the script, include both of the following scripting objects:<ul class="ul" id="concept_qcz_ssq_1y__d81486e250">
                        <li class="li"> sdcFunctions.createEvent(String type, int version) - Creates an event
                            record with the specified event type and version number. You can create
                            a new event type or use an existing event type. Existing event types are
                            documented in other event-generating stages. <p class="p">The event record
                                contains no record fields. Generate record fields as
                            needed.</p>
</li>

                        <li class="li"> sdcFunctions.toEvent(Record) - Use to pass events to the event output
                            stream. </li>

                    </ul>
</li>

            </ol>
</div>

    </div>

</div>
<div class="topic concept nested1" id="concept_uw4_kqw_1y">
    <h2 class="title topictitle2">Working with Record Header Attributes</h2>

    <div class="body conbody">
        <p class="p">You can use the
            Groovy Evaluator <span class="ph">processor to read and update
                or create record header attributes.</span></p>

        <p class="p">Use a map when creating or updating a header attribute. If a header
            attribute exists, the processor updates the value, if it does not exist, the processor
            creates the attribute and sets it to the specified value. </p>

        <p class="p">All records include a set of read-only record header attributes that
            stages can update as they process the records. Error records also have their own set of
            read-only header attributes.</p>

        <p class="p">Some stages generate custom record header attributes that are meant to be
            used in particular ways. For example, the Oracle CDC Client origin specifies the
            operation type for a record in a record header attribute. And event-generating stages
            create a set of event header attributes for event records. For more information, see
                <a class="xref" href="../Pipeline_Design/RecordHeaderAttributes.html#concept_wn2_jcz_dz">Record Header Attributes</a>.</p>

        <div class="p">The processor provides the following record header variables to work with
            header attributes:<ul class="ul" id="concept_uw4_kqw_1y__d81486e289">
                <li class="li"><samp class="ph codeph">record.&lt;header name&gt;</samp> - Use to return the value of a
                    read-only header attribute.</li>

                <li class="li"><samp class="ph codeph">record.attributes</samp> - Use to return a map of custom record header
                    attributes, or to create or update a specific record header attribute.</li>

            </ul>
</div>

        <div class="note tip"><span class="tiptitle">Tip:</span> Use data preview to view the record header attributes
            included in a record.</div>

    </div>

<div class="topic concept nested2" id="concept_jsz_qdy_1y">
 <h3 class="title topictitle3">Viewing Record Header Attributes</h3>

 <div class="body conbody">
        <p class="p"><span class="ph">You can use data preview to view the record header attributes
                associated with a record at any given point in the pipeline. To view record header
                attributes, enable the Show Record/Field Header data preview property.</span></p>

        <p class="p">For example, the following image shows a record generated by the
            Directory origin in data preview. </p>

        <p class="p"><img class="image" id="concept_jsz_qdy_1y__d81486e320" src="../Reusable_Content/Reusable_Topics/../../Graphics/HeaderAttribute-Preview.png" height="241" width="335" /></p>

        <p class="p"><span class="ph" id="concept_jsz_qdy_1y__d81486e323">The "Record Header" list displays the set of
                read-only internal attributes in the record at this point of the pipeline.</span> You
            can use the <samp class="ph codeph">record.&lt;header name&gt;</samp> variable to return values for these
            attributes. </p>

        <p class="p"><span class="ph" id="concept_jsz_qdy_1y__d81486e331">The header attributes under "values" are the
                attributes created by the Directory origin.</span> You can use the
                <samp class="ph codeph">record.attributes</samp> variable to return or modify these attributes.
            When you use the <samp class="ph codeph">record.attributes</samp> variable to create a header
            attribute, it displays in this location during data preview.</p>

 </div>

</div>
</div>
<div class="topic concept nested1" id="concept_t35_rsy_mx">
 <h2 class="title topictitle2">Accessing Whole File Format Records</h2>

 <div class="body conbody">
        <p class="p">In a pipeline that processes the whole file
            data format, you can use a Groovy Evaluator to read the whole file data.</p>

        <p class="p">The processor can access the fileref field in a whole file
                  record by creating an input stream using the getInputStream() API. For example,
                  you might use the processor to read the file data in the fileref field and then
                  create new records with the data. The processor can access the fileref field, but
                  cannot modify information in the field.</p>

        <div class="p">Use the following lines to create and then read the input
                  stream:<pre class="pre codeblock">input_stream = record.value['fileRef'].getInputStream()
input_stream.read()</pre>
</div>

        <div class="p">After the processor reads the input stream, include the
                  following line in the code to close the input
                  stream:<pre class="pre codeblock">input_stream.close()</pre>
</div>

 </div>

    <div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="../Data_Formats/WholeFile.html#concept_nfc_qkh_xw" title="Whole File Data Format">Whole File Data Format</a></div>
</div>
</div>
</div>
<div class="topic concept nested1" id="concept_vjg_wpt_bz">
 <h2 class="title topictitle2">Calling External Java Code</h2>

 
 <div class="body conbody"><p class="shortdesc">You can call external Java code from the Groovy Evaluator. Simply install the external
        Java library to make it available to the Groovy Evaluator. Then, call the external Java code
        from the Groovy script that you develop for the processor. </p>

        <p class="p"><span class="ph">For information about installing additional drivers, see
                              <a class="xref" href="../Configuration/ExternalLibs.html#concept_pdv_qlw_ft" title="After you've set up the external directory, use the Package Manager within Data Collector to install external libraries.To manually install external libraries, use the required procedure for your installation type.">Install External Libraries</a>.</span></p>

        <div class="p">To call the external Java code from the Groovy Evaluator, simply add an import statement
            like so to your script:<pre class="pre codeblock">import &lt;package&gt;.&lt;class name&gt;</pre>
</div>

        <div class="p">For example, let's say that you installed the Bouncy Castle JAR file to compute SHA-3
            (Secure Hash Algorithm 3) digests. Add the following statement to your
            script:<pre class="pre codeblock">import org.bouncycastle.jcajce.provider.digest.SHA3</pre>
</div>

        <p class="p">For more details, see the following StreamSets blog post: <a class="xref" href="https://streamsets.com/blog/calling-external-java-code-script-evaluators/" target="_blank">Calling External Java Code from Script
                Evaluators</a>.</p>

 </div>

</div>
<div class="topic task nested1" id="task_otr_swr_nx">
    <h2 class="title topictitle2">Granting Permissions on Groovy Scripts</h2>

    <div class="body taskbody">
        <div class="section context" id="task_otr_swr_nx__context_nbk_l24_nbb">If <span class="ph">Data
                  Collector</span> is
            using the Java Security Manager and the Groovy code needs to access network resources,
            you must update the Data Collector security policy to include Groovy scripts. The Java
            Security Manager is enabled by default. For more information, see <a class="xref" href="../Configuration/DCEnvironmentConfig.html#concept_tm4_pbg_ht" title="Data Collector includes a Java Security Manager that is enabled by default.">Java Security Manager</a>.</div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In the <span class="ph">Data
                  Collector</span> configuration directory, edit the security policy:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock">$SDC_CONF/sdc-security.policy</pre>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Add the following lines to the file:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock">// groovy source code
grant codebase "file:///groovy/script" { 
  &lt;permissions&gt;;
};</pre>

                    <p class="p">Where &lt;permissions&gt; are the permissions you are granting to the Groovy
                        scripts.</p>

                    <div class="p">For example, to grant read permission on all files in the
                            <samp class="ph codeph">/data/files</samp> directory and subdirectories, add the
                        following
                        lines:<pre class="pre codeblock">// groovy source code
grant codebase "file:///groovy/script" { 
  permission java.util.PropertyPermission "*", "read";
  permission java.io.FilePermission "/data/files/*", "read";
};</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Restart <span class="ph">Data
                  Collector</span>.</span>
            </li>
</ol>

    </div>

</div>
<div class="topic task nested1" id="task_asl_bpt_gv">
    <h2 class="title topictitle2">Configuring a Groovy Evaluator</h2>

    <div class="body taskbody">
        <div class="section context">
            <p class="p">Configure a Groovy Evaluator
                to use custom Groovy code in a pipeline.</p>

        </div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In the Properties panel, on the <span class="keyword wintitle">General</span> tab, configure the
                    following properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_asl_bpt_gv__table_vvw_s1h_cy" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr>
                                    <th class="entry" valign="top" width="30%" id="d439593e896">General Property</th>

                                    <th class="entry" valign="top" width="70%" id="d439593e899">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">Name</td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Stage name.</td>

                                </tr>

                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">Description</td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Optional description.</td>

                                </tr>

                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">Produce Events <a class="xref" href="Groovy.html#concept_qcz_ssq_1y">
                                            <img class="image" id="task_asl_bpt_gv__image_fnz_31h_cy" src="../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Generates event records when
                                        events occur. Use for event handling. <a class="xref" href="../Event_Handling/EventFramework-Title.html#concept_cph_5h4_lx">
                                            <img class="image" id="task_asl_bpt_gv__d79886e5276" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                </tr>

                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">Required Fields <a class="xref" href="../Pipeline_Design/DroppingUnwantedRecords.html#concept_dnj_bkm_vq">
                                            <img class="image" id="task_asl_bpt_gv__d79886e5285" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Fields that must include data for the record to be passed
                                        into the stage. <div class="note tip"><span class="tiptitle">Tip:</span> You might
                                            include fields that the stage uses.</div>
<p class="p">Records
                                            that do not include all required fields are processed
                                            based on the error handling configured for the
                                            pipeline.</p>
</td>

                                </tr>

                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">Preconditions <a class="xref" href="../Pipeline_Design/DroppingUnwantedRecords.html#concept_msl_yd4_fs">
                                            <img class="image" id="task_asl_bpt_gv__d79886e5301" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Conditions that must evaluate to TRUE to allow a record
                                        to enter the stage for processing. Click
                                            <span class="ph uicontrol">Add</span> to create additional
                                        preconditions. <p class="p">Records that do not meet all preconditions
                                            are processed based on the error handling configured for
                                            the stage.</p>
</td>

                                </tr>

                                <tr>
                                    <td class="entry" valign="top" width="30%" headers="d439593e896 ">On Record Error <a class="xref" href="../Pipeline_Design/ErrorHandling.html#concept_atr_j4y_5r">
                                            <img class="image" id="task_asl_bpt_gv__d79886e5319" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d439593e899 ">Error record handling for the stage: <ul class="ul" id="task_asl_bpt_gv__d79886e5323">
                                            <li class="li">Discard - Discards the record.</li>

                                            <li class="li">Send to Error - Sends the record to the pipeline for
                                                error handling.</li>

                                            <li class="li">Stop Pipeline - Stops the pipeline. Not valid for
                                                cluster pipelines.</li>

                                        </ul>
</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the <span class="keyword wintitle">Groovy</span> tab, configure the following
                    properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_asl_bpt_gv__table_kqw_xpt_gv" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr>
                                    <th class="entry" valign="top" width="22.22222222222222%" id="d439593e1028">Groovy Evaluator Property</th>

                                    <th class="entry" valign="top" width="77.77777777777779%" id="d439593e1031">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr>
                                    <td class="entry" valign="top" width="22.22222222222222%" headers="d439593e1028 ">Record Processing Mode
                                        <a class="xref" href="Groovy.html#concept_ljq_z2t_gv" title="You can choose the processing mode that the Groovy Evaluator uses to process the main script. You can use the same script in each processing mode. However, you should include error handling in the main script before you run in batch mode.">
                                            <img class="image" id="task_asl_bpt_gv__image_jet_15l_hw" src="../Graphics/icon_moreInfo.png" height="12" width="12" /></a></td>

                                    <td class="entry" valign="top" width="77.77777777777779%" headers="d439593e1031 ">Determines how the Groovy Evaluator processes the main
                                        script: <ul class="ul" id="task_asl_bpt_gv__ul_vqy_kqt_gv">
                                            <li class="li">Record by Record - Processes records individually.
                                                Performs error handling.</li>

                                            <li class="li">Batch by Batch - Processes records in batches.
                                                Requires error handling code in the script.</li>

                                        </ul>
<p class="p">Default is Batch by Batch.</p>
</td>

                                </tr>

                                <tr>
      <td class="entry" valign="top" width="22.22222222222222%" headers="d439593e1028 ">Init Script</td>

      <td class="entry" valign="top" width="77.77777777777779%" headers="d439593e1031 ">Optional initialization script to use in the processor.<p class="p">Use to set up connections or
       resources required by the processor. Runs once when the pipeline starts.</p>
</td>

     </tr>
<tr>
     <td class="entry" valign="top" width="22.22222222222222%" headers="d439593e1028 ">Script</td>

     <td class="entry" valign="top" width="77.77777777777779%" headers="d439593e1031 ">Main processing script to use in the processor.<p class="p">Runs for each record or each batch of
       data, based on the configured processing mode.</p>
</td>

    </tr>
<tr>
     <td class="entry" valign="top" width="22.22222222222222%" headers="d439593e1028 ">Destroy Script</td>

     <td class="entry" valign="top" width="77.77777777777779%" headers="d439593e1031 ">Optional destroy script to use in the processor.<p class="p">Use to close any connections or
       resources required by the processor. Runs once when the pipeline stops.</p>
</td>

    </tr>

                                <tr>
                                    <td class="entry" valign="top" width="22.22222222222222%" headers="d439593e1028 ">Enable invokedynamic Compiler Option</td>

                                    <td class="entry" valign="top" width="77.77777777777779%" headers="d439593e1031 ">Enables the use of the invokedynamic bytecode
                                        instruction. <p class="p">This can affect performance differently
                                            depending on the use case. For more information about
                                            Groovy invokedynamic support, see <a class="xref" href="http://groovy-lang.org/indy.html" target="_blank">http://groovy-lang.org/indy.html</a>.</p>
</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
</ol>

    </div>

</div>
</div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../Processors/Processors_title.html" title="Processors"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Processors</span></a></span>  </div><div class="footer" id="webhelp_copyright_information"><!--

    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

--><!-- SDC google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60917135-3', 'auto');
  ga('send', 'pageview');
</script></div>
</body>
</html>