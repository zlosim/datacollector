
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="If you develop custom stages, store the stage libraries in a local directory external to the Data Collector installation directory. Use an external directory to enable use of the custom stage ..." /><meta name="copyright" content="(C) Copyright 2005" /><meta name="DC.rights.owner" content="(C) Copyright 2005" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Custom Stage Libraries" /><meta name="DC.Relation" scheme="URI" content="../Configuration/Config_title.html" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="concept_pmc_jk1_1x" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Custom Stage Libraries</title><!--  Generated with Oxygen version 18.1, build number 2016112217.  --><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/skins/skin.css" /><link rel="stylesheet" type="text/css" href="../skin.css" /><script type="text/javascript"><!--
            
            var prefix = "../index.html";
            
            --></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.11.3.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script>
<!--
    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
</head>
<body onload="highlightSearchTerm()" class="frmBody">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td style="width:75%;"><span class="topic_breadcrumb_links"><span class="topic_breadcrumb_link"><a class="navheader_parent_path" href="../Configuration/Config_title.html" title="Configuration">Configuration</a></span></span></td><td><span id="topic_navigation_links" class="navheader">
<span class="navparent"><a class="link" href="../Configuration/Config_title.html" title="Configuration"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Configuration</span></a></span>  </span></td></tr></tbody></table>
<div class="nested0" id="concept_pmc_jk1_1x">
 <h1 class="title topictitle1">Custom Stage Libraries</h1>

 <div class="body conbody">
  <p class="p">If you develop custom stages,
            store the stage libraries in a local directory external to the <span class="ph">Data
                  Collector</span>
            installation directory. Use an external directory to enable use of the custom stage
            libraries after <span class="ph">Data
                  Collector</span>
            upgrades.</p>

        <p class="p">Use the required procedure for your installation type.</p>

        <p class="p">We have tutorials for creating a custom origin, processor, and destination on our
            StreamSets tutorials page. To check them out, go to: <a class="xref" href="https://github.com/streamsets/tutorials" target="_blank">https://github.com/streamsets/tutorials</a>. </p>

 </div>

<div class="related-links"></div>
<div class="topic task nested1" id="task_hyk_sk1_1x">
    <h2 class="title topictitle2">Storing Custom Libraries for RPM and Tarball</h2>

    <div class="body taskbody">
        <div class="section context">
            <p class="p">To store custom stage libraries for an RPM or tarball installation, perform the
                following steps:</p>

        </div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Create a local directory external to the <span class="ph">Data
                  Collector</span> installation directory for the custom stage libraries. Use an external
                    directory to enable use of the libraries after <span class="ph">Data
                  Collector</span> upgrades.</span>
                <div class="itemgroup info">
                    <div class="p">For example, if you installed <span class="ph">Data
                  Collector</span> in the following directory: <pre class="pre codeblock">/opt/sdc/</pre>
</div>

                    <div class="p">you might create the custom stage library directory at:
                        <pre class="pre codeblock">/opt/sdc-user-libs</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Copy the custom stage libraries to the directory. Use a directory structure for
                    each custom stage.</span>
                <div class="itemgroup info">
                    <div class="p">For example to store libraries for a custom stage named customstage1, you
                        would copy them to the following directory:
                        <pre class="pre codeblock">/opt/sdc-user-libs/customstage1</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">In the <span class="ph">Data
                  Collector</span> environment configuration file located in the
                        <samp class="ph codeph">$SDC_DIST/libexec</samp> directory, add the USER_LIBRARIES_DIR
                    environment variable and point it to the custom stage library directory.</span>
                <div class="itemgroup info">
                    <p class="p">Modify the <a class="xref" href="DCEnvironmentConfig.html#concept_rng_qym_qr" title="You can edit the Data Collector environment configuration file to modify the directories used to store configuration, data, log, and resource files.When you run Data Collector as a service, Data Collector runs as the system user account and group defined in environment variables. The default system user and group are named sdc.Increase or decrease the Data Collector Java heap size as necessary, based on the resources available on the host machine. By default, the Java heap size is 1024 MB. You can enable remote debugging to debug a Data Collector instance running on a remote machine. You can define the Java garbage collector that Data Collector uses. By default, Data Collector uses the Concurrent Mark Sweep (CMS) garbage collector.Data Collector includes a Java Security Manager that is enabled by default. You can edit the Data Collector environment configuration file to configure the path to JAR files to be added to the Data Collector root classloader.">environment configuration file</a> used by your installation type.</p>

                    <p class="p">Set the environment variable as follows:</p>

                    <pre class="pre codeblock">export USER_LIBRARIES_DIR="&lt;custom stage library directory&gt;"</pre>

                    <p class="p">For example: </p>

                    <pre class="pre codeblock">export USER_LIBRARIES_DIR="/opt/sdc-user-libs/"</pre>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">When using the Java Security Manager, which is enabled by default, update the
                        <span class="ph">Data
                  Collector</span> security policy to include the custom stage library directory as
                    follows:</span>
                <ol type="a" class="ol substeps" id="task_hyk_sk1_1x__substeps_xsd_xx1_1x">
                    <li class="li substep substepexpand">
                        <span class="ph cmd">In the <span class="ph">Data
                  Collector</span> configuration directory, open the security policy file:</span>
                        <div class="itemgroup info">
                            <pre class="pre codeblock">$SDC_CONF/sdc-security.policy</pre>

                        </div>
                    </li>

                    <li class="li substep substepexpand">
                        <span class="ph cmd">Add the following lines to the file:</span>
                        <div class="itemgroup info">
                            <pre class="pre codeblock">// custom stage library directory
grant codebase "file://&lt;custom stage library directory&gt;-" {
   permission java.security.AllPermission;
};</pre>

                            <div class="p">For
                                example:<pre class="pre codeblock">// custom stage library directory
grant codebase "file:///opt/sdc-user-libs/-" {
   permission java.security.AllPermission;
};</pre>
</div>

                        </div>
                    </li>

                </ol>

            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Restart <span class="ph">Data
                  Collector</span>.</span>
                <div class="itemgroup info">The <span class="ph">Data
                  Collector</span> stage library displays the custom stages.</div>
            </li>
</ol>

    </div>

    <div class="related-links"><div class="relinfo"><strong>Related information</strong><br />
<div class="related_link"><a class="navheader_parent_path" href="DCEnvironmentConfig.html#concept_rng_qym_qr" title="You can edit the Data Collector environment configuration file to modify the directories used to store configuration, data, log, and resource files.When you run Data Collector as a service, Data Collector runs as the system user account and group defined in environment variables. The default system user and group are named sdc.Increase or decrease the Data Collector Java heap size as necessary, based on the resources available on the host machine. By default, the Java heap size is 1024 MB. You can enable remote debugging to debug a Data Collector instance running on a remote machine. You can define the Java garbage collector that Data Collector uses. By default, Data Collector uses the Concurrent Mark Sweep (CMS) garbage collector.Data Collector includes a Java Security Manager that is enabled by default. You can edit the Data Collector environment configuration file to configure the path to JAR files to be added to the Data Collector root classloader.">Data Collector Environment Configuration</a></div>
</div>
</div>
</div>
<div class="topic task nested1" id="task_qvz_xdb_1x">
    <h2 class="title topictitle2">Storing Custom Libraries for Cloudera Manager</h2>

    <div class="body taskbody">
        <div class="section context">
            <p class="p">To store custom stage libraries for a Cloudera Manager installation, perform the
                following steps:</p>

        </div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In Cloudera Manager, select the <span class="ph uicontrol">StreamSets</span> service and
                    then click <span class="ph uicontrol">Configuration</span>.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the <span class="keyword wintitle">Configuration</span> page, in the <span class="ph uicontrol">Data
                        Collector Advanced Configuration Snippet (Safety Valve) for
                        sdc-env.sh</span> field, add the USER_LIBRARIES_DIR environment
                    variable and point it to the custom stage library directory, as follows:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock">export USER_LIBRARIES_DIR="&lt;custom stage library directory&gt;"</pre>

                    <div class="p">For
                        example:<pre class="pre codeblock">export USER_LIBRARIES_DIR="/opt/sdc-user-libs/"</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On every node that runs <span class="ph">Data
                  Collector</span>, copy the custom stage libraries to the directory defined for the
                    USER_LIBRARIES_DIR environment variable. Use a directory structure for each
                    custom stage.</span>
                <div class="itemgroup info">For example to store libraries for a custom stage named customstage1, you
                    would copy them to the following directory:
                    <pre class="pre codeblock">/opt/sdc-user-libs/customstage1</pre>
</div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">When using the Java Security Manager, which is enabled by default, update the
                        <span class="ph uicontrol">Data Collector Advanced Configuration Snippet (Safety Valve) for
                        sdc-security.policy</span> property to include the custom stage library
                    directory as follows:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock">// custom stage library directory
grant codebase "file://&lt;custom stage library directory&gt;-" {
   permission java.security.AllPermission;
};</pre>

                    <div class="p">For
                        example:<pre class="pre codeblock">// custom stage library directory
grant codebase "file:///opt/sdc-user-libs/-" {
   permission java.security.AllPermission;
};</pre>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Restart <span class="ph">Data
                  Collector</span>.</span>
            </li>
</ol>

    </div>

</div>
</div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../Configuration/Config_title.html" title="Configuration"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Configuration</span></a></span>  </div><div class="footer" id="webhelp_copyright_information"><!--

    Copyright 2017 StreamSets Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

--><!-- SDC google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60917135-3', 'auto');
  ga('send', 'pageview');
</script></div>
</body>
</html>